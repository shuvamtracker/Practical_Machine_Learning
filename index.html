<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>Exercise Manner Prediction Using Data from Accelerometers on the Belt, Forearm, Arm and Dumbbell of Participants</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>




</head>

<body>
<!-- rmarkdown v1 -->

<h1>Exercise Manner Prediction Using Data from Accelerometers on the Belt, Forearm, Arm and Dumbbell of Participants</h1>

<h2>Synopsis</h2>

<p>Using devices such as Jawbone Up, Nike FuelBand, and Fitbit it is now possible to collect a large amount of data about personal activity relatively inexpensively. These type of devices are part of the quantified self movement – a group of enthusiasts who take measurements about themselves regularly to improve their health, to find patterns in their behavior, or because they are tech geeks. One thing that people regularly do is quantify how much of a particular activity they do, but they rarely quantify how well they do it. In this project, we will be using data from accelerometers on the belt, forearm, arm, and dumbbell of 6 participants to predict the manner in which they did the exercise. They were asked to perform barbell lifts correctly and incorrectly in 5 different ways.</p>

<h2>Exploratory Data Analysis</h2>

<p>We obtained the <a href="https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv">Training Data</a> and the <a href="https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv">Testing Data</a> from the source[1] in the references section.</p>

<p>First, we load the required libraries for this analysis.</p>

<pre><code class="r">library(dplyr)
library(caret)
library(parallel)
library(doParallel)
</code></pre>

<h3>Reading in the data</h3>

<p>The data for this assignment is in the form of a comma-separated-value file (.csv). We download the data in raw form.</p>

<pre><code class="r">if(!file.exists(&quot;./pml-training.csv&quot;))
{
    download.file(&quot;https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv&quot;,
                  &quot;./pml-training.csv&quot;)     
}

if(!file.exists(&quot;./pml-testing.csv&quot;))
{
    download.file(&quot;https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv&quot;,
                  &quot;./pml-testing.csv&quot;)

}
</code></pre>

<p>Now, we read in the training data from the raw csv file. Then we look at the dimension of the training data and the name of the columns to find out the columns of interest.</p>

<pre><code class="r">trdata &lt;- data.table::fread(&quot;./pml-training.csv&quot;) %&gt;%
    as_tibble 

dim(trdata); 
</code></pre>

<pre><code>## [1] 19622   160
</code></pre>

<pre><code class="r">names(trdata);
</code></pre>

<pre><code>##   [1] &quot;V1&quot;                       &quot;user_name&quot;               
##   [3] &quot;raw_timestamp_part_1&quot;     &quot;raw_timestamp_part_2&quot;    
##   [5] &quot;cvtd_timestamp&quot;           &quot;new_window&quot;              
##   [7] &quot;num_window&quot;               &quot;roll_belt&quot;               
##   [9] &quot;pitch_belt&quot;               &quot;yaw_belt&quot;                
##  [11] &quot;total_accel_belt&quot;         &quot;kurtosis_roll_belt&quot;      
##  [13] &quot;kurtosis_picth_belt&quot;      &quot;kurtosis_yaw_belt&quot;       
##  [15] &quot;skewness_roll_belt&quot;       &quot;skewness_roll_belt.1&quot;    
##  [17] &quot;skewness_yaw_belt&quot;        &quot;max_roll_belt&quot;           
##  [19] &quot;max_picth_belt&quot;           &quot;max_yaw_belt&quot;            
##  [21] &quot;min_roll_belt&quot;            &quot;min_pitch_belt&quot;          
##  [23] &quot;min_yaw_belt&quot;             &quot;amplitude_roll_belt&quot;     
##  [25] &quot;amplitude_pitch_belt&quot;     &quot;amplitude_yaw_belt&quot;      
##  [27] &quot;var_total_accel_belt&quot;     &quot;avg_roll_belt&quot;           
##  [29] &quot;stddev_roll_belt&quot;         &quot;var_roll_belt&quot;           
##  [31] &quot;avg_pitch_belt&quot;           &quot;stddev_pitch_belt&quot;       
##  [33] &quot;var_pitch_belt&quot;           &quot;avg_yaw_belt&quot;            
##  [35] &quot;stddev_yaw_belt&quot;          &quot;var_yaw_belt&quot;            
##  [37] &quot;gyros_belt_x&quot;             &quot;gyros_belt_y&quot;            
##  [39] &quot;gyros_belt_z&quot;             &quot;accel_belt_x&quot;            
##  [41] &quot;accel_belt_y&quot;             &quot;accel_belt_z&quot;            
##  [43] &quot;magnet_belt_x&quot;            &quot;magnet_belt_y&quot;           
##  [45] &quot;magnet_belt_z&quot;            &quot;roll_arm&quot;                
##  [47] &quot;pitch_arm&quot;                &quot;yaw_arm&quot;                 
##  [49] &quot;total_accel_arm&quot;          &quot;var_accel_arm&quot;           
##  [51] &quot;avg_roll_arm&quot;             &quot;stddev_roll_arm&quot;         
##  [53] &quot;var_roll_arm&quot;             &quot;avg_pitch_arm&quot;           
##  [55] &quot;stddev_pitch_arm&quot;         &quot;var_pitch_arm&quot;           
##  [57] &quot;avg_yaw_arm&quot;              &quot;stddev_yaw_arm&quot;          
##  [59] &quot;var_yaw_arm&quot;              &quot;gyros_arm_x&quot;             
##  [61] &quot;gyros_arm_y&quot;              &quot;gyros_arm_z&quot;             
##  [63] &quot;accel_arm_x&quot;              &quot;accel_arm_y&quot;             
##  [65] &quot;accel_arm_z&quot;              &quot;magnet_arm_x&quot;            
##  [67] &quot;magnet_arm_y&quot;             &quot;magnet_arm_z&quot;            
##  [69] &quot;kurtosis_roll_arm&quot;        &quot;kurtosis_picth_arm&quot;      
##  [71] &quot;kurtosis_yaw_arm&quot;         &quot;skewness_roll_arm&quot;       
##  [73] &quot;skewness_pitch_arm&quot;       &quot;skewness_yaw_arm&quot;        
##  [75] &quot;max_roll_arm&quot;             &quot;max_picth_arm&quot;           
##  [77] &quot;max_yaw_arm&quot;              &quot;min_roll_arm&quot;            
##  [79] &quot;min_pitch_arm&quot;            &quot;min_yaw_arm&quot;             
##  [81] &quot;amplitude_roll_arm&quot;       &quot;amplitude_pitch_arm&quot;     
##  [83] &quot;amplitude_yaw_arm&quot;        &quot;roll_dumbbell&quot;           
##  [85] &quot;pitch_dumbbell&quot;           &quot;yaw_dumbbell&quot;            
##  [87] &quot;kurtosis_roll_dumbbell&quot;   &quot;kurtosis_picth_dumbbell&quot; 
##  [89] &quot;kurtosis_yaw_dumbbell&quot;    &quot;skewness_roll_dumbbell&quot;  
##  [91] &quot;skewness_pitch_dumbbell&quot;  &quot;skewness_yaw_dumbbell&quot;   
##  [93] &quot;max_roll_dumbbell&quot;        &quot;max_picth_dumbbell&quot;      
##  [95] &quot;max_yaw_dumbbell&quot;         &quot;min_roll_dumbbell&quot;       
##  [97] &quot;min_pitch_dumbbell&quot;       &quot;min_yaw_dumbbell&quot;        
##  [99] &quot;amplitude_roll_dumbbell&quot;  &quot;amplitude_pitch_dumbbell&quot;
## [101] &quot;amplitude_yaw_dumbbell&quot;   &quot;total_accel_dumbbell&quot;    
## [103] &quot;var_accel_dumbbell&quot;       &quot;avg_roll_dumbbell&quot;       
## [105] &quot;stddev_roll_dumbbell&quot;     &quot;var_roll_dumbbell&quot;       
## [107] &quot;avg_pitch_dumbbell&quot;       &quot;stddev_pitch_dumbbell&quot;   
## [109] &quot;var_pitch_dumbbell&quot;       &quot;avg_yaw_dumbbell&quot;        
## [111] &quot;stddev_yaw_dumbbell&quot;      &quot;var_yaw_dumbbell&quot;        
## [113] &quot;gyros_dumbbell_x&quot;         &quot;gyros_dumbbell_y&quot;        
## [115] &quot;gyros_dumbbell_z&quot;         &quot;accel_dumbbell_x&quot;        
## [117] &quot;accel_dumbbell_y&quot;         &quot;accel_dumbbell_z&quot;        
## [119] &quot;magnet_dumbbell_x&quot;        &quot;magnet_dumbbell_y&quot;       
## [121] &quot;magnet_dumbbell_z&quot;        &quot;roll_forearm&quot;            
## [123] &quot;pitch_forearm&quot;            &quot;yaw_forearm&quot;             
## [125] &quot;kurtosis_roll_forearm&quot;    &quot;kurtosis_picth_forearm&quot;  
## [127] &quot;kurtosis_yaw_forearm&quot;     &quot;skewness_roll_forearm&quot;   
## [129] &quot;skewness_pitch_forearm&quot;   &quot;skewness_yaw_forearm&quot;    
## [131] &quot;max_roll_forearm&quot;         &quot;max_picth_forearm&quot;       
## [133] &quot;max_yaw_forearm&quot;          &quot;min_roll_forearm&quot;        
## [135] &quot;min_pitch_forearm&quot;        &quot;min_yaw_forearm&quot;         
## [137] &quot;amplitude_roll_forearm&quot;   &quot;amplitude_pitch_forearm&quot; 
## [139] &quot;amplitude_yaw_forearm&quot;    &quot;total_accel_forearm&quot;     
## [141] &quot;var_accel_forearm&quot;        &quot;avg_roll_forearm&quot;        
## [143] &quot;stddev_roll_forearm&quot;      &quot;var_roll_forearm&quot;        
## [145] &quot;avg_pitch_forearm&quot;        &quot;stddev_pitch_forearm&quot;    
## [147] &quot;var_pitch_forearm&quot;        &quot;avg_yaw_forearm&quot;         
## [149] &quot;stddev_yaw_forearm&quot;       &quot;var_yaw_forearm&quot;         
## [151] &quot;gyros_forearm_x&quot;          &quot;gyros_forearm_y&quot;         
## [153] &quot;gyros_forearm_z&quot;          &quot;accel_forearm_x&quot;         
## [155] &quot;accel_forearm_y&quot;          &quot;accel_forearm_z&quot;         
## [157] &quot;magnet_forearm_x&quot;         &quot;magnet_forearm_y&quot;        
## [159] &quot;magnet_forearm_z&quot;         &quot;classe&quot;
</code></pre>

<p>As we can see, there are 19622 rows in the dataset with 160 columns. From those, we conclude that, for this analysis, our outcome column is <strong><em>classe</em></strong>. The first 7 columns are most likely identifying variables for the participants, so we choose to discard those, keeping only the <strong><em>classe</em></strong> column and the columns containing in their names <strong><em>belt, forearm, arm, and dumbbell</em></strong>. We also ensure that <strong><em>classe</em></strong> is a factor variable for further analyses.</p>

<h3>Selection of attributes</h3>

<pre><code class="r">trdata &lt;- trdata %&gt;% select(-c(V1:num_window)) %&gt;%
    mutate(classe = factor(classe))
</code></pre>

<h3>Cleaning the data</h3>

<p>We now calculate the percentage of missing values in the extracted training dataset.</p>

<pre><code class="r">mean(is.na(trdata))
</code></pre>

<pre><code>## [1] 0.6412377
</code></pre>

<p>The percentage of missing values in the training dataset is 64.1237693%, which unusually high. So, we examine the percentage of missing values in each column and find out a summary of the distribution.</p>

<pre><code class="r">naPercent &lt;- sapply(trdata, function(col) mean(is.na(col)))
plot(naPercent*100,
     xlab = &quot;column index&quot;,
     ylab = &quot;%missing values&quot;,
     main = &quot;%missing values vs column index&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk columnmissing"/></p>

<pre><code class="r">summary(naPercent)
</code></pre>

<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.0000  0.0000  0.9793  0.6412  0.9793  1.0000
</code></pre>

<p>As we can see, the median is <strong><em>0.9793089</em></strong>, which suggests that at least half of our columns have more than <strong><em>97.9308939%</em></strong> missing values. The figure also suggests that the rest of the columns have near 0% missing values. We take this median value as cutoff value and discard all the columns that have <strong><em>more%</em></strong> missing values than this percentage.</p>

<pre><code class="r">mdnNApt &lt;- median(naPercent)
selectedCol &lt;- (naPercent &lt;= 1-mdnNApt)

trdata &lt;- trdata %&gt;%
    select_if(selectedCol)
</code></pre>

<p>Let&#39;s look at the dimensions of the extracted dataset.</p>

<pre><code class="r">dim(trdata)
</code></pre>

<pre><code>## [1] 19622    53
</code></pre>

<p>So, the number of columns has come down from 160 in the original dataset to 53.</p>

<h2>Training Partition</h2>

<p>For model prediction, we first partition <strong><em>(3:1)</em></strong> our whole training dataset into two subsets: training and validation. We will build our model on the training set and evaluate performance on the validation set.</p>

<pre><code class="r">set.seed(911)
inTrain &lt;- createDataPartition(trdata$classe, p = 3/4, list = FALSE)
training &lt;- trdata[ inTrain,]
validation &lt;- trdata[-inTrain,]
</code></pre>

<p>Before we begin training, let&#39;s look at the dimensions of the training and validation sets.</p>

<pre><code class="r">dim(training)
</code></pre>

<pre><code>## [1] 14718    53
</code></pre>

<pre><code class="r">dim(validation)
</code></pre>

<pre><code>## [1] 4904   53
</code></pre>

<h2>Building Prediction Models</h2>

<p>For our models, we will use a 3-fold cross-validation to ensure better performance. We will also use parallel processing to speed up training.  </p>

<h3>Model 1: Decision Tree</h3>

<p>As our outcome variable is categorical, we will first build a simple Decision Tree classifier. We then look its performance on the training set itself.</p>

<pre><code class="r">cluster &lt;- makeCluster(detectCores()-1)
registerDoParallel(cluster)

set.seed(911)
modelDT &lt;- train(classe~., data = training, method = &quot;rpart&quot;, 
                 trControl = trainControl(method = &quot;cv&quot;, number = 3,
                                          allowParallel = TRUE))

stopCluster(cluster)
registerDoSEQ()

print(modelDT)
</code></pre>

<pre><code>## CART 
## 
## 14718 samples
##    52 predictor
##     5 classes: &#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;, &#39;E&#39; 
## 
## No pre-processing
## Resampling: Cross-Validated (3 fold) 
## Summary of sample sizes: 9812, 9812, 9812 
## Resampling results across tuning parameters:
## 
##   cp          Accuracy   Kappa    
##   0.03379854  0.4988450  0.3556277
##   0.06028672  0.3660823  0.1243948
##   0.11421248  0.3380894  0.0817684
## 
## Accuracy was used to select the optimal model using the largest value.
## The final value used for the model was cp = 0.03379854.
</code></pre>

<pre><code class="r">confDTtr &lt;- confusionMatrix(predict(modelDT, training), training$classe)
print(confDTtr)
</code></pre>

<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 3815 1160 1191 1065  397
##          B   56  976   85  428  371
##          C  306  712 1291  919  727
##          D    0    0    0    0    0
##          E    8    0    0    0 1211
## 
## Overall Statistics
##                                           
##                Accuracy : 0.4955          
##                  95% CI : (0.4874, 0.5036)
##     No Information Rate : 0.2843          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.3408          
##                                           
##  Mcnemar&#39;s Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity            0.9116  0.34270  0.50292   0.0000  0.44752
## Specificity            0.6380  0.92081  0.78076   1.0000  0.99933
## Pos Pred Value         0.5001  0.50939  0.32642      NaN  0.99344
## Neg Pred Value         0.9478  0.85377  0.88145   0.8361  0.88925
## Prevalence             0.2843  0.19350  0.17441   0.1639  0.18386
## Detection Rate         0.2592  0.06631  0.08772   0.0000  0.08228
## Detection Prevalence   0.5183  0.13018  0.26872   0.0000  0.08282
## Balanced Accuracy      0.7748  0.63175  0.64184   0.5000  0.72343
</code></pre>

<p>As we can see, the overall accuracy is 49.55% which means the in-sample error is 50.45%. It is very high, indicating there is high bias in our model. So, we decide to discard this model and build a better model.</p>

<h3>Model 2: Random Forest</h3>

<p>Now, we build a Random Forest classifier. As earlier, we use 3-fold cross validation and parallel processing. We then look its performance on the training set itself.</p>

<pre><code class="r">cluster &lt;- makeCluster(detectCores()-1)
registerDoParallel(cluster)

set.seed(911)
modelRF &lt;- train(classe~., data = training, method = &quot;rf&quot;, verbose = FALSE, 
             trControl = trainControl(method = &quot;cv&quot;, number = 3,
             allowParallel = TRUE))

stopCluster(cluster)
registerDoSEQ()

print(modelRF)
</code></pre>

<pre><code>## Random Forest 
## 
## 14718 samples
##    52 predictor
##     5 classes: &#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;, &#39;E&#39; 
## 
## No pre-processing
## Resampling: Cross-Validated (3 fold) 
## Summary of sample sizes: 9812, 9812, 9812 
## Resampling results across tuning parameters:
## 
##   mtry  Accuracy   Kappa    
##    2    0.9902840  0.9877086
##   27    0.9881777  0.9850429
##   52    0.9805680  0.9754154
## 
## Accuracy was used to select the optimal model using the largest value.
## The final value used for the model was mtry = 2.
</code></pre>

<pre><code class="r">confRFtr &lt;- confusionMatrix(predict(modelRF, training), training$classe)
print(confRFtr)
</code></pre>

<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 4185    0    0    0    0
##          B    0 2848    0    0    0
##          C    0    0 2567    0    0
##          D    0    0    0 2412    0
##          E    0    0    0    0 2706
## 
## Overall Statistics
##                                      
##                Accuracy : 1          
##                  95% CI : (0.9997, 1)
##     No Information Rate : 0.2843     
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16  
##                                      
##                   Kappa : 1          
##                                      
##  Mcnemar&#39;s Test P-Value : NA         
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity            1.0000   1.0000   1.0000   1.0000   1.0000
## Specificity            1.0000   1.0000   1.0000   1.0000   1.0000
## Pos Pred Value         1.0000   1.0000   1.0000   1.0000   1.0000
## Neg Pred Value         1.0000   1.0000   1.0000   1.0000   1.0000
## Prevalence             0.2843   0.1935   0.1744   0.1639   0.1839
## Detection Rate         0.2843   0.1935   0.1744   0.1639   0.1839
## Detection Prevalence   0.2843   0.1935   0.1744   0.1639   0.1839
## Balanced Accuracy      1.0000   1.0000   1.0000   1.0000   1.0000
</code></pre>

<p>As we can see, the overall accuracy is 100% which means the in-sample error is 0%. So, there is low bias(actually, no bias) in our model. But, this may be due to overfitting. Let&#39;s evaluate this model on the validation set to see how much variance there is.</p>

<pre><code class="r">confRFval &lt;- confusionMatrix(predict(modelRF, newdata=validation), validation$classe)
print(confRFval)
</code></pre>

<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 1390    8    0    0    0
##          B    4  938   15    0    0
##          C    0    3  840   11    0
##          D    0    0    0  793    3
##          E    1    0    0    0  898
## 
## Overall Statistics
##                                           
##                Accuracy : 0.9908          
##                  95% CI : (0.9877, 0.9933)
##     No Information Rate : 0.2845          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.9884          
##                                           
##  Mcnemar&#39;s Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity            0.9964   0.9884   0.9825   0.9863   0.9967
## Specificity            0.9977   0.9952   0.9965   0.9993   0.9998
## Pos Pred Value         0.9943   0.9801   0.9836   0.9962   0.9989
## Neg Pred Value         0.9986   0.9972   0.9963   0.9973   0.9993
## Prevalence             0.2845   0.1935   0.1743   0.1639   0.1837
## Detection Rate         0.2834   0.1913   0.1713   0.1617   0.1831
## Detection Prevalence   0.2851   0.1951   0.1741   0.1623   0.1833
## Balanced Accuracy      0.9971   0.9918   0.9895   0.9928   0.9982
</code></pre>

<p>As we can see, the overall accuracy is 99.08% which means the expected out of sample error is 0.92%. It is very low, indicating there is also low variance in our model. As our RF model is showing both low bias and low variance, we decide on this model to be the final model.</p>

<p>Let&#39;s have a visual representation of our model&#39;s predictions on the validation set to see which examples it got wrong.</p>

<pre><code class="r">plot(1:dim(validation)[1], 
     predict(modelRF, newdata=validation), 
     col = validation$classe,
     xlab = &quot;Example No.&quot;,
     ylab = &quot;Predicted Class&quot;,
     main = &quot;Validation Set&quot;)
legend(&quot;bottomright&quot;, legend = c(&quot;A=1&quot;, &quot;B=2&quot;, &quot;C=3&quot;, &quot;D=4&quot;, &quot;E=5&quot;), 
       col = c(&quot;black&quot;, &quot;red&quot;, &quot;green&quot;, &quot;blue&quot;, &quot;cyan&quot;), lw = 2)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk valplot"/></p>

<h2>Evaluation on the Test Dataset</h2>

<p>We now load the testing dataset and perform similar transformations (as we did to our training set) on it first and then apply our RF model to the extracted set.</p>

<pre><code class="r">tsdata &lt;- data.table::fread(&quot;./pml-testing.csv&quot;) %&gt;%
    as_tibble %&gt;% select(-c(V1:num_window)) %&gt;%
    select_if(selectedCol)

dim(tsdata)
</code></pre>

<pre><code>## [1] 20 53
</code></pre>

<pre><code class="r">testing &lt;- tsdata

predRFtest &lt;- predict(modelRF, newdata=testing)
print(predRFtest)
</code></pre>

<pre><code>##  [1] B A B A A E D B A A B C B A E E A B B B
## Levels: A B C D E
</code></pre>

<h2>References</h2>

<p>[1]: Source <a href="http://web.archive.org/web/20161224072740/http:/groupware.les.inf.puc-rio.br/har">http://web.archive.org/web/20161224072740/http:/groupware.les.inf.puc-rio.br/har</a></p>

</body>

</html>

